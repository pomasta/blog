<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Peter Omasta" />


<title>Steelhead Salmon at Bonneville Dam</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Blog</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="hares.html">Snowshoe Hares</a>
</li>
<li>
  <a href="bonneville.html">Bonneville Dam</a>
</li>
<li>
  <a href="hawaii.html">Hawaiian Maps</a>
</li>
<li>
  <a href="farming.html">Farming</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pomasta">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/peter-omasta-a87b5783/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Steelhead Salmon at Bonneville Dam</h1>
<h4 class="author">Peter Omasta</h4>
<h4 class="date">2/18/2020</h4>

</div>


<pre class="r"><code>knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)

#attach necessary packages
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(paletteer)
library(tsibble)
library(fable)
library(fabletools)
library(feasts)
library(forecast)</code></pre>
<div id="introduction" class="section level3">
<h3><strong>Introduction:</strong></h3>
<p>This data was provided by the Columbia Basin Research DART, which is affiliated with the University of Washington [1]. The data set goes back to 1939 and shows the daily record of the number of steelhead salmon that have passed through the Bonneville Dam which was built across the Columbia River that seperates Oregon and Washington. The Bonneville Dam has a fish ladder that was constructed in 1937 which has helped facilitate migration of steelhead salmon and other salmon species back to their spawning grounds. [2] Steelhead salmon were added onto the Endangered Species Act in 1999, and this analysis will partially look at how populations, as measured by movement up the river, have responded since that time. [3]</p>
<p><img src="images/bonneville_dam.jpg" style="width:100%; margin-right: 20px" align="left"></p>
<pre class="r"><code>#read in data file

salmon_data &lt;- read_csv(here::here(&quot;data&quot;,&quot;cbr_fish_passage_bonneville_allyrs_steelhead.csv&quot;)) %&gt;% 
  janitor::clean_names()</code></pre>
<pre class="r"><code>#start by tidying and cleaning up the data set, getting dates into different columns, combing for one aggregate date column, and parsing out each column separately to work in tsibble with

salmon_clean &lt;- salmon_data %&gt;% 
  unite(&quot;ydm&quot;, year:mm_dd, sep = &quot;-&quot;, remove=FALSE) %&gt;% 
  mutate(yr_mon_day = parse_date_time(ydm, &quot;ydm&quot;)) %&gt;% 
  mutate(yr_mon = parse_date_time(ydm, &quot;ym&quot;)) %&gt;% 
  mutate(month = month(yr_mon_day, label = TRUE)) %&gt;% 
  mutate(year = year(yr_mon_day)) %&gt;% 
  mutate(day = day(yr_mon_day)) %&gt;% 
  mutate(value = as.numeric(value)) %&gt;% 
  mutate(yr_mon_day = as_date(yr_mon_day)) %&gt;% 
  drop_na()</code></pre>
<pre class="r"><code>#alright, now time to create the different time series data frames 

#first A finalized time series plot of the original observations (daily data)

salmon_daily &lt;- ggplot(data = salmon_clean, aes(x = ydm, y = value, group = year)) +
  geom_line(aes(color = month)) + 
  theme_minimal()

salmon_daily + scale_color_paletteer_d((&quot;palettetown::alakazam&quot;))</code></pre>
<p><img src="bonneville_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>#this graph makes me want to throw up, I am going to cut down the time frame </code></pre>
</div>
<div id="daily-count-information" class="section level3">
<h3><strong>Daily Count Information</strong></h3>
<pre class="r"><code>#second attempt at the daily graph
daily_df &lt;- salmon_clean %&gt;% 
  filter(year %in% c(&quot;2015&quot;,&quot;2016&quot;,&quot;2017&quot;,&quot;2018&quot;,&quot;2019&quot;)) 

daily_graph &lt;- ggplot(data = daily_df, aes(x = yr_mon_day, y = value)) +
  geom_point(aes(color = value)) +
  labs(
    title = &quot;Bonneville Dam Daily Steelhead Salmon Passage&quot;,
    subtitle = &quot;From 2015 to 2019&quot;,
    x = &quot;Date&quot;,
    y = &quot;Number of Steelhead Salmon per Day&quot;,
    color = &quot;Number of Salmon Counted&quot;
  ) +
  theme_minimal()
daily_graph + scale_color_paletteer_c((&quot;gameofthrones::targaryen&quot;))</code></pre>
<div class="figure">
<img src="bonneville_files/figure-html/unnamed-chunk-4-1.png" alt="The figure shows the individual counts of steelhead salmon at the Bonneville Dam from 2015 to 2019. Each individual point represents one day. Each year starts on Januaray 1st, and ends December 31st." width="672" />
<p class="caption">
The figure shows the individual counts of steelhead salmon at the Bonneville Dam from 2015 to 2019. Each individual point represents one day. Each year starts on Januaray 1st, and ends December 31st.
</p>
</div>
<div id="discussion" class="section level4">
<h4><strong>Discussion</strong></h4>
<ul>
<li>The figure above shows the daily counts of steelhead from the Bonneville Dam. There appears to be a trend among daily peaks occuring in the late summer months (August / September) but the peaks are decreasing as time goes on. While there does not appear to be any seasonality shift, lets look at monthly data from a longer time period to see if there is a discernable shift in salmon counts.</li>
</ul>
</div>
</div>
<div id="monthly-count-information" class="section level3">
<h3><strong>Monthly Count Information</strong></h3>
<pre class="r"><code>#create a dataframe that has monthly counts
month_df &lt;- salmon_clean %&gt;% 
  group_by(year, month) %&gt;% 
  summarize(
    month_count = sum(value)
  ) %&gt;% 
  drop_na() %&gt;% 
  filter(year %in% c(1975:2019))

month_graph &lt;- ggplot(month_df, aes(x = year, y = month_count)) +
  geom_line(aes(color = month),
            size = 1.2,
            alpha = 0.8) +
  labs(
    title = &quot;Monthly Steelhead Salmon Count at Bonneville Dam&quot;,
    subtitle = &quot;Collected from 1975 - 2019&quot;,
    x = &quot;Year&quot;,
    y = &quot;# of Steelhead Salmon&quot;,
    color = &quot;Month&quot;
  ) +
  theme_minimal() +
  scale_y_continuous(limits = c(0, 150000)) +
  scale_x_continuous(limits = c(1975, 2020))

month_graph + scale_color_paletteer_d((&quot;rcartocolor::Antique&quot;))</code></pre>
<div class="figure">
<img src="bonneville_files/figure-html/unnamed-chunk-5-1.png" alt="This figure shows the monthly counts for steelhead salmon at the Bonneville Dam from 1975 until 2019. With the 80 year data set, each month is seperated, and values were derived by summing together daily counts from the dam by month and year." width="672" />
<p class="caption">
This figure shows the monthly counts for steelhead salmon at the Bonneville Dam from 1975 until 2019. With the 80 year data set, each month is seperated, and values were derived by summing together daily counts from the dam by month and year.
</p>
</div>
<pre class="r"><code>#looks good lets see if we can make this as a tsibble seasonal plot to see trends 

#create a tsibble data frame
month_ts &lt;- as_tsibble(salmon_clean, key = month, index = yr_mon_day)

#hmm data frame has NAs, need to drop them or fill them

filled_month_ts &lt;- fill_gaps(month_ts, .full = FALSE)
filled_month_ts %&gt;% gg_season(value)</code></pre>
<p><img src="bonneville_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>#that is terrible to look at

autoplot(filled_month_ts)</code></pre>
<p><img src="bonneville_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="r"><code>#this also tells me nothing, lets just stick with the original plot</code></pre>
<div id="discussion-1" class="section level4">
<h4><strong>Discussion</strong></h4>
<p>-Steelhead salmon are known to begin their run tpically in August. This is the period of their life where they return back to the stream in which they were born to reproduce and also die [4]. Throughout the time series data shown above, we see the highest runs and count of salmon being in these late summer months, primarily August, but occasionally in September. For the remainder of the year counts are relatively low. While there is a pattern of salmon movement between different months, there does not appear to be a trend between months increasing or decreasing, but rather they are indicating more annual trends than seasonal.</p>
</div>
</div>
<div id="annual-count-information" class="section level3">
<h3><strong>Annual Count Information</strong></h3>
<pre class="r"><code>#annual counts

annual_df &lt;- salmon_clean %&gt;% 
  group_by(year) %&gt;% 
  summarize(
    annual_count = sum(value, na.rm = TRUE)
  )

annual_graph &lt;- ggplot(annual_df, aes(x = year, y = annual_count)) +
  geom_line(size = 1.2,
            color = &quot;darkred&quot;) +
  labs(
    title = &quot;Annual Steelhead Salmon Count at Bonneville Dam&quot;,
    subtitle = &quot;Collected from 1939 - 2019&quot;,
    x = &quot;Year&quot;,
    y = &quot;# of Steelhead Salmon&quot;
  ) +
  theme_minimal() +
  scale_y_continuous(limits = c(0, 300000)) +
  scale_x_continuous(limits = c(1935, 2020))

annual_graph</code></pre>
<div class="figure">
<img src="bonneville_files/figure-html/unnamed-chunk-7-1.png" alt="The figure above shows the annual counts of steelhead salmon from the Bonneville Dam from 1939 - 2019. Data was collected by summing daily counts for the entire year. The y-axis of 6 e+05 represents 300,000 total salmon for the year." width="672" />
<p class="caption">
The figure above shows the annual counts of steelhead salmon from the Bonneville Dam from 1939 - 2019. Data was collected by summing daily counts for the entire year. The y-axis of 6 e+05 represents 300,000 total salmon for the year.
</p>
</div>
<div id="discussion-2" class="section level4">
<h4><strong>Discussion:</strong></h4>
<p>-The graph above shows the annual counts of steelhead salmon from the Bonneville Dam since data started being recorded in 1939. Steelhead salmon along the Columbia river had gained protected status under the Endangered Species act in 1999, and the graph above shows that in the decade following their listing the amount of salmon going through the dam increased dramatically.</p>
</div>
</div>
<div id="citations" class="section level3">
<h3><strong>Citations:</strong></h3>
<ul>
<li><ol style="list-style-type: decimal">
<li>Boggs, C. T., M. L. Keefer, C. A. Peery, T. C. Bjornn, and L. C. Stuehrenberg. “Fallback, Reascension, and Adjusted Fishway Escapement Estimates for Adult Chinook Salmon and Steelhead at Columbia and Snake River Dams.” Transactions of the American Fisheries Society 133, no. 4 (July 1, 2004): 932–49. <a href="https://doi.org/10.1577/T03-133.1" class="uri">https://doi.org/10.1577/T03-133.1</a>.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>“DART Adult Passage Graphics &amp; Text | Columbia Basin Research.” Accessed February 19, 2020. <a href="http://www.cbr.washington.edu/dart/query/adult_graph_text" class="uri">http://www.cbr.washington.edu/dart/query/adult_graph_text</a>.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>“Endangered Species Act, Columbia River Salmon and Steelhead, and the Biological Opinion.” Accessed February 20, 2020. <a href="https://www.nwcouncil.org/reports/columbia-river-history/endangeredspeciesact" class="uri">https://www.nwcouncil.org/reports/columbia-river-history/endangeredspeciesact</a>.</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Raymond, Howard L. “Effects of Hydroelectric Development and Fisheries Enhancement on Spring and Summer Chinook Salmon and Steelhead in the Columbia River Basin.” North American Journal of Fisheries Management 8, no. 1 (February 1, 1988): 1–24. <a href="https://doi.org/10.1577/1548-8675(1988)008" class="uri">https://doi.org/10.1577/1548-8675(1988)008</a>&lt;0001:EOHDAF&gt;2.3.CO;2.</li>
</ol></li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
